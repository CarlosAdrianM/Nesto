<UserControl x:Class="FacturarRutasPopup"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:prism="http://prismlibrary.com/"
             prism:ViewModelLocator.AutoWireViewModel="True"
             Width="450"
             Background="White">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- TÃ­tulo -->
        <TextBlock Grid.Row="0"
                   Text="Seleccione el tipo de ruta a facturar:"
                   FontSize="14" FontWeight="SemiBold"
                   Margin="0,0,0,15"/>

        <!-- Opciones de ruta DINÃMICAS -->
        <ListBox Grid.Row="1"
                 ItemsSource="{Binding TiposRutaDisponibles}"
                 SelectedItem="{Binding TipoRutaSeleccionado}"
                 Margin="0,0,0,20"
                 BorderThickness="0"
                 Background="Transparent">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <RadioButton Content="{Binding DisplayText}"
                                 IsChecked="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"
                                 GroupName="TipoRuta"
                                 FontSize="13"/>
                </DataTemplate>
            </ListBox.ItemTemplate>
            <ListBox.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListBoxItem">
                                <ContentPresenter Margin="0,0,0,10"/>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListBox.ItemContainerStyle>
        </ListBox>

        <!-- Progress Bar -->
        <ProgressBar Grid.Row="2"
                     Height="20"
                     Margin="0,0,0,10"
                     IsIndeterminate="True">
            <ProgressBar.Style>
                <Style TargetType="ProgressBar">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding EstaProcesando}" Value="True">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ProgressBar.Style>
        </ProgressBar>

        <!-- Mensaje de estado -->
        <ScrollViewer Grid.Row="3" VerticalScrollBarVisibility="Auto">
            <TextBlock Text="{Binding MensajeEstado}"
                       TextWrapping="Wrap"
                       FontSize="12"
                       Foreground="{Binding ColorMensaje}"
                       VerticalAlignment="Top"/>
        </ScrollViewer>

        <!-- Botones -->
        <StackPanel Grid.Row="4"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,15,0,0">
            <Button Content="Ver Resumen"
                    Width="110"
                    Height="30"
                    Margin="0,0,10,0"
                    Command="{Binding VerResumenCommand}"/>
            <Button Content="Facturar"
                    Width="100"
                    Height="30"
                    Margin="0,0,10,0"
                    Command="{Binding FacturarCommand}"/>
            <Button Content="Cancelar"
                    Width="100"
                    Height="30"
                    Command="{Binding CancelarCommand}"/>
        </StackPanel>
    </Grid>
</UserControl>
